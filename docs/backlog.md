# Engineering Backlog

This backlog collects cross-cutting or future action items that emerge from reviews and planning.

Routing guidance:

- Use this file for non-urgent optimizations, refactors, or follow-ups that span multiple stories/epics.
- Must-fix items to ship a story belong in that story's `Tasks / Subtasks`.
- Same-epic improvements may also be captured under the epic Tech Spec `Post-Review Follow-ups` section.

| Date | Story | Epic | Type | Severity | Owner | Status | Notes |
| ---- | ----- | ---- | ---- | -------- | ----- | ------ | ----- |
| 2025-10-16 | 1.5 | 1 | TechDebt | Medium | DEV | Open | Add automated test coverage for RedisCacheRepository. Defer to Story 1.8 (CI/CD). Related AC#5. Files: Create LlmTokenPrice.Infrastructure.Tests/Caching/RedisCacheRepositoryTests.cs |
| 2025-10-16 | 1.5 | 1 | Enhancement | Medium | TBD | Open | Consider implementing Polly retry logic for transient Redis failures (3 retries with exponential backoff). Defer to Phase 2. Related files: RedisCacheRepository.cs |
| 2025-10-16 | 1.5 | 1 | Enhancement | Low | TBD | Open | Add cache key validation utility for defense-in-depth security. Create CacheKeys.ValidateKey() method with alphanumeric + colon/hyphen validation, max 250 chars. |
| 2025-10-16 | 1.5 | 1 | Bug | Low | Pablo | **Done** | Clean up corrupted cache entries on JSON deserialization failure. RedisCacheRepository.cs:71-73 - Added DeleteAsync call on JsonException. Completed 2025-10-16. |
| 2025-10-16 | 1.5 | 1 | Documentation | Low | Pablo | **Done** | Document CancellationToken limitation in ICacheRepository interface XML comments. Added note to all 4 methods explaining StackExchange.Redis 2.7.10 limitation. Completed 2025-10-16. |
| 2025-10-16 | 1.8 | 1 | Documentation | Medium | SM | Open | Add Story Context XML documentation for CI/CD architectural decisions (service containers, trigger patterns, caching strategy). Create docs/story-context-1.8.xml. Related AC#5, AC#6. |
| 2025-10-16 | 1.8 | 1 | TechDebt | Medium | Pablo | **Done** | Implement code coverage reporting in backend pipeline. Added coverlet.collector v6.0.2 + Codecov upload to backend-ci.yml with XPlat Code Coverage collection. Generates coverage.cobertura.xml. Completed 2025-10-16. Related AC#1. |
| 2025-10-16 | 1.8 | 1 | Enhancement | Medium | Pablo | **Done** | Add ESLint security plugins for XSS/injection detection. Installed eslint-plugin-security v3.0.1 + eslint-plugin-no-unsanitized v4.1.4. Configured 9 security rules in eslint.config.js (detect-unsafe-regex, detect-eval-with-expression, no-unsanitized/method, etc.). Completed 2025-10-16. Related AC#2. |
| 2025-10-16 | 1.8 | 1 | TechDebt | Low | DEV | Open | Expand unit test coverage to all domain entities (Capability, Benchmark, BenchmarkScore). Create CapabilityTests.cs, BenchmarkTests.cs, BenchmarkScoreTests.cs following ModelTests.cs pattern. Defer to Story 1.10. Related AC#1. |
| 2025-10-16 | 1.8 | 1 | Enhancement | Low | Pablo | **Done** | Optimize frontend pipeline with node_modules caching. Added cache step to .github/workflows/frontend-ci.yml with pnpm-lock.yaml hash key. Expected 5-10s improvement on cache hit. Completed 2025-10-16. Related AC#2. |
| 2025-10-16 | 1.9 | 1 | TechDebt | Low | Pablo | **Done** | Add unit tests for SampleDataSeeder. Created LlmTokenPrice.Infrastructure.Tests xUnit project with SampleDataSeederTests.cs containing 3 comprehensive tests: (1) SeedAsync_WithEmptyDatabase_SeedsCorrectCounts (validates 10 models, 5 benchmarks, 34+ scores), (2) SeedAsync_WithExistingData_SkipsSeeding (idempotency check), (3) SeedAsync_CreatesCorrectRelationships (Model → Capability 1:1, Model → Scores 1:N, provider diversity). All 3 tests passing. Completed 2025-10-16. Related AC#1, AC#3. |
| 2025-10-16 | 1.9 | 1 | Enhancement | Low | Pablo | **Done** | Add benchmark score validation helper in SampleDataSeeder. Created CreateScore() private method to validate scores fall within benchmark's TypicalRangeMin/Max. Throws ArgumentOutOfRangeException with descriptive message if validation fails. Updated GPT-4 benchmark scores to use helper method. Completed 2025-10-16. File: SampleDataSeeder.cs:144-163. Related AC#2. |
| 2025-10-16 | 1.10 | 1 | TechDebt | Low | Pablo | **Done** | Add unit tests for ModelQueryService mapping edge cases. Created LlmTokenPrice.Application.Tests project with ModelQueryServiceTests.cs containing 6 comprehensive unit tests: (1) GetAllModelsAsync_WithNullCapability_ReturnsNullCapabilityDto, (2) GetAllModelsAsync_WithZeroBenchmarks_ReturnsEmptyTopBenchmarks, (3) GetAllModelsAsync_WithFiveBenchmarks_ReturnsOnlyTop3OrderedByScoreDesc, (4) GetAllModelsAsync_WithValidModel_MapsAllFieldsCorrectly, (5) GetModelByIdAsync_WhenModelNotFound_ReturnsNull, (6) GetModelByIdAsync_WhenModelExists_ReturnsMappedDto. All tests passing (6/6). Completed 2025-10-16. Files: LlmTokenPrice.Application.Tests/Services/ModelQueryServiceTests.cs. Related AC#3. |
| 2025-10-16 | 1.10 | 1 | Documentation | Low | SM | Open | Generate story context documentation for Story 1.10. Run story-context workflow to create story-context-1.10.xml for Dev Agent Record consistency. Update story-1.10.md:158 with context reference path. |
| 2025-10-16 | 1.10 | 1 | Bug | Low | Pablo | **Done** | Fix EF Core version conflict in Infrastructure.Tests. Updated LlmTokenPrice.Infrastructure.Tests.csproj to use EF Core 9.0.10 (aligned with Infrastructure project). Build now shows 0 warnings, 0 errors. Completed 2025-10-16. Command: dotnet add package Microsoft.EntityFrameworkCore.Relational --version 9.0.10. Files: services/backend/LlmTokenPrice.Infrastructure.Tests/LlmTokenPrice.Infrastructure.Tests.csproj:9. |
